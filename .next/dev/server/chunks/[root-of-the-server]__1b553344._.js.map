{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/davilaacostarenzojhair/DESARROLLO/Nyutku%20Systems/parroquia-icm-nextjs/src/lib/db/postgres.ts"],"sourcesContent":["import { Pool, PoolClient, QueryResult } from 'pg';\n\n// Singleton pattern para la conexión a PostgreSQL\nlet pool: Pool | null = null;\n\n/**\n * Obtiene o crea una instancia del pool de conexiones a PostgreSQL\n */\nexport function getPool(): Pool {\n  if (!pool) {\n    pool = new Pool({\n      host: process.env.DB_HOST,\n      port: parseInt(process.env.DB_PORT || '5432'),\n      database: process.env.DB_NAME,\n      user: process.env.DB_USER,\n      password: process.env.DB_PASSWORD,\n      ssl: process.env.DB_SSL === 'true' ? { rejectUnauthorized: false } : false,\n      max: 20, // Máximo de conexiones en el pool\n      idleTimeoutMillis: 30000, // Tiempo antes de cerrar una conexión inactiva\n      connectionTimeoutMillis: 2000, // Tiempo máximo de espera para obtener una conexión\n    });\n\n    // Manejar errores del pool\n    pool.on('error', (err) => {\n      console.error('Error inesperado en el pool de PostgreSQL:', err);\n    });\n  }\n\n  return pool;\n}\n\n/**\n * Ejecuta una consulta SQL con parámetros\n */\nexport async function query<T = any>(\n  text: string,\n  params?: any[]\n): Promise<QueryResult<T>> {\n  const pool = getPool();\n  const start = Date.now();\n  \n  try {\n    const result = await pool.query<T>(text, params);\n    const duration = Date.now() - start;\n    \n    // Log en desarrollo\n    if (process.env.NODE_ENV === 'development') {\n      console.log('Consulta ejecutada:', { text, duration, rows: result.rowCount });\n    }\n    \n    return result;\n  } catch (error) {\n    console.error('Error en consulta SQL:', error);\n    throw error;\n  }\n}\n\n/**\n * Obtiene una conexión del pool para ejecutar transacciones\n */\nexport async function getClient(): Promise<PoolClient> {\n  const pool = getPool();\n  return await pool.connect();\n}\n\n/**\n * Ejecuta una transacción\n */\nexport async function transaction<T>(\n  callback: (client: PoolClient) => Promise<T>\n): Promise<T> {\n  const client = await getClient();\n  \n  try {\n    await client.query('BEGIN');\n    const result = await callback(client);\n    await client.query('COMMIT');\n    return result;\n  } catch (error) {\n    await client.query('ROLLBACK');\n    throw error;\n  } finally {\n    client.release();\n  }\n}\n\n/**\n * Cierra el pool de conexiones (útil para testing o shutdown graceful)\n */\nexport async function closePool(): Promise<void> {\n  if (pool) {\n    await pool.end();\n    pool = null;\n  }\n}\n\n/**\n * Verifica si la conexión a la base de datos está funcionando\n */\nexport async function testConnection(): Promise<boolean> {\n  try {\n    const result = await query('SELECT NOW() as current_time');\n    console.log('Conexión a PostgreSQL exitosa:', result.rows[0]);\n    return true;\n  } catch (error) {\n    console.error('Error al conectar a PostgreSQL:', error);\n    return false;\n  }\n}\n\n// Tipos de utilidad para resultados de queries comunes\nexport interface DbResult<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\n/**\n * Helper para manejar errores de base de datos de forma consistente\n */\nexport function handleDbError(error: any): DbResult<never> {\n  console.error('Error de base de datos:', error);\n  \n  // Errores comunes de PostgreSQL\n  if (error.code === '23505') {\n    return { success: false, error: 'El registro ya existe (duplicado)' };\n  }\n  \n  if (error.code === '23503') {\n    return { success: false, error: 'Violación de clave foránea' };\n  }\n  \n  if (error.code === '23502') {\n    return { success: false, error: 'Campo obligatorio faltante' };\n  }\n  \n  return { \n    success: false, \n    error: process.env.NODE_ENV === 'development' \n      ? error.message \n      : 'Error al procesar la solicitud' \n  };\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;;;;;AAEA,kDAAkD;AAClD,IAAI,OAAoB;AAKjB,SAAS;IACd,IAAI,CAAC,MAAM;QACT,OAAO,IAAI,4GAAI,CAAC;YACd,MAAM,QAAQ,GAAG,CAAC,OAAO;YACzB,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;YACtC,UAAU,QAAQ,GAAG,CAAC,OAAO;YAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO;YACzB,UAAU,QAAQ,GAAG,CAAC,WAAW;YACjC,KAAK,QAAQ,GAAG,CAAC,MAAM,KAAK,SAAS;gBAAE,oBAAoB;YAAM,IAAI;YACrE,KAAK;YACL,mBAAmB;YACnB,yBAAyB;QAC3B;QAEA,2BAA2B;QAC3B,KAAK,EAAE,CAAC,SAAS,CAAC;YAChB,QAAQ,KAAK,CAAC,8CAA8C;QAC9D;IACF;IAEA,OAAO;AACT;AAKO,eAAe,MACpB,IAAY,EACZ,MAAc;IAEd,MAAM,OAAO;IACb,MAAM,QAAQ,KAAK,GAAG;IAEtB,IAAI;QACF,MAAM,SAAS,MAAM,KAAK,KAAK,CAAI,MAAM;QACzC,MAAM,WAAW,KAAK,GAAG,KAAK;QAE9B,oBAAoB;QACpB,wCAA4C;YAC1C,QAAQ,GAAG,CAAC,uBAAuB;gBAAE;gBAAM;gBAAU,MAAM,OAAO,QAAQ;YAAC;QAC7E;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,MAAM;IACR;AACF;AAKO,eAAe;IACpB,MAAM,OAAO;IACb,OAAO,MAAM,KAAK,OAAO;AAC3B;AAKO,eAAe,YACpB,QAA4C;IAE5C,MAAM,SAAS,MAAM;IAErB,IAAI;QACF,MAAM,OAAO,KAAK,CAAC;QACnB,MAAM,SAAS,MAAM,SAAS;QAC9B,MAAM,OAAO,KAAK,CAAC;QACnB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,OAAO,KAAK,CAAC;QACnB,MAAM;IACR,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAKO,eAAe;IACpB,IAAI,MAAM;QACR,MAAM,KAAK,GAAG;QACd,OAAO;IACT;AACF;AAKO,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM,MAAM;QAC3B,QAAQ,GAAG,CAAC,kCAAkC,OAAO,IAAI,CAAC,EAAE;QAC5D,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO;IACT;AACF;AAYO,SAAS,cAAc,KAAU;IACtC,QAAQ,KAAK,CAAC,2BAA2B;IAEzC,gCAAgC;IAChC,IAAI,MAAM,IAAI,KAAK,SAAS;QAC1B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAoC;IACtE;IAEA,IAAI,MAAM,IAAI,KAAK,SAAS;QAC1B,OAAO;YAAE,SAAS;YAAO,OAAO;QAA6B;IAC/D;IAEA,IAAI,MAAM,IAAI,KAAK,SAAS;QAC1B,OAAO;YAAE,SAAS;YAAO,OAAO;QAA6B;IAC/D;IAEA,OAAO;QACL,SAAS;QACT,OAAO,uCACH,MAAM,OAAO,GACb;IACN;AACF"}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///Users/davilaacostarenzojhair/DESARROLLO/Nyutku%20Systems/parroquia-icm-nextjs/src/app/api/reservations/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { query, transaction, handleDbError } from '@/lib/db/postgres';\nimport type { \n  CreateReservationRequest, \n  CreateReservationResponse,\n  MassType \n} from '@/lib/db/types';\n\n/**\n * Genera un código de confirmación único\n */\nfunction generateConfirmationCode(): string {\n  const timestamp = Date.now().toString(36).toUpperCase();\n  const random = Math.random().toString(36).substring(2, 8).toUpperCase();\n  return `ICM-${timestamp}-${random}`;\n}\n\n/**\n * Obtiene la IP del cliente desde los headers\n */\nfunction getClientIp(request: NextRequest): string | null {\n  const forwarded = request.headers.get('x-forwarded-for');\n  const realIp = request.headers.get('x-real-ip');\n  \n  if (forwarded) {\n    return forwarded.split(',')[0].trim();\n  }\n  \n  return realIp || null;\n}\n\n/**\n * POST /api/reservations\n * Crea una nueva reserva de misa\n */\nexport async function POST(request: NextRequest) {\n  try {\n    const body: CreateReservationRequest = await request.json();\n\n    // Validar campos obligatorios\n    const requiredFields = [\n      'date',\n      'time',\n      'nombre',\n      'apellidos',\n      'dni',\n      'telefono',\n      'email',\n      'tipoMisa',\n      'intencion',\n      'metodoPago',\n    ];\n\n    for (const field of requiredFields) {\n      if (!body[field as keyof CreateReservationRequest]) {\n        return NextResponse.json(\n          {\n            success: false,\n            error: `El campo \"${field}\" es obligatorio`,\n          },\n          { status: 400 }\n        );\n      }\n    }\n\n    // Validar formato de fecha\n    const dateRegex = /^\\d{4}-\\d{2}-\\d{2}$/;\n    if (!dateRegex.test(body.date)) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Formato de fecha inválido',\n        },\n        { status: 400 }\n      );\n    }\n\n    // Validar que la fecha no sea en el pasado\n    const reservationDate = new Date(body.date + 'T00:00:00');\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    if (reservationDate < today) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'No se pueden hacer reservas para fechas pasadas',\n        },\n        { status: 400 }\n      );\n    }\n\n    // Validar DNI (8 dígitos)\n    if (!/^\\d{8}$/.test(body.dni)) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'El DNI debe tener exactamente 8 dígitos',\n        },\n        { status: 400 }\n      );\n    }\n\n    // Validar email\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(body.email)) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'El formato del correo electrónico no es válido',\n        },\n        { status: 400 }\n      );\n    }\n\n    // Obtener información del cliente\n    const clientIp = getClientIp(request);\n    const userAgent = request.headers.get('user-agent');\n\n    // Ejecutar la inserción dentro de una transacción\n    const result = await transaction(async (client) => {\n      // Verificar que el horario siga disponible\n      const availabilityCheck = await client.query(\n        `SELECT \n          mat.max_reservations,\n          COUNT(mr.id) as current_reservations\n        FROM mass_available_times mat\n        LEFT JOIN mass_reservations mr ON \n          mr.reservation_time = mat.time AND \n          mr.reservation_date = $1 AND\n          mr.status NOT IN ('cancelled')\n        WHERE mat.time = $2 AND mat.is_active = true\n        GROUP BY mat.max_reservations`,\n        [body.date, body.time]\n      );\n\n      if (availabilityCheck.rows.length === 0) {\n        throw new Error('El horario seleccionado no está disponible');\n      }\n\n      const { max_reservations, current_reservations } = availabilityCheck.rows[0];\n      if (parseInt(current_reservations) >= max_reservations) {\n        throw new Error('El horario seleccionado ya no está disponible');\n      }\n\n      // Obtener el precio del tipo de misa\n      const priceResult = await client.query<MassType>(\n        `SELECT precio FROM mass_types WHERE tipo_misa = $1 AND is_active = true`,\n        [body.tipoMisa]\n      );\n\n      if (priceResult.rows.length === 0) {\n        throw new Error('Tipo de misa no válido');\n      }\n\n      const precio = parseFloat(priceResult.rows[0].precio.toString());\n\n      // Generar código de confirmación\n      const confirmationCode = generateConfirmationCode();\n\n      // Determinar estado inicial según método de pago\n      const status = body.metodoPago === 'transferencia' ? 'payment_pending' : 'pending';\n\n      // Insertar la reserva\n      const insertResult = await client.query(\n        `INSERT INTO mass_reservations (\n          reservation_date,\n          reservation_time,\n          location,\n          nombre,\n          apellidos,\n          dni,\n          telefono,\n          email,\n          tipo_misa,\n          intencion,\n          difuntos,\n          observaciones,\n          precio,\n          metodo_pago,\n          comprobante_url,\n          pago_verificado,\n          status,\n          confirmation_code,\n          ip_address,\n          user_agent\n        ) VALUES (\n          $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20\n        ) RETURNING id, confirmation_code`,\n        [\n          body.date,\n          body.time,\n          'Parroquia', // Por defecto, puede ser parametrizable\n          body.nombre,\n          body.apellidos,\n          body.dni,\n          body.telefono,\n          body.email.toLowerCase(),\n          body.tipoMisa,\n          body.intencion,\n          body.difuntos || null,\n          body.observaciones || null,\n          precio,\n          body.metodoPago,\n          body.comprobanteUrl || null,\n          false, // pago_verificado\n          status,\n          confirmationCode,\n          clientIp,\n          userAgent,\n        ]\n      );\n\n      return {\n        reservationId: insertResult.rows[0].id,\n        confirmationCode: insertResult.rows[0].confirmation_code,\n      };\n    });\n\n    // TODO: Enviar correo de confirmación\n    // await sendConfirmationEmail(body.email, result.confirmationCode);\n\n    const response: CreateReservationResponse = {\n      success: true,\n      message: body.metodoPago === 'transferencia'\n        ? 'Reserva creada exitosamente. Te contactaremos para validar tu transferencia.'\n        : 'Reserva creada exitosamente. Recuerda acercarte a la secretaría para realizar el pago.',\n      reservationId: result.reservationId,\n      confirmationCode: result.confirmationCode,\n    };\n\n    return NextResponse.json(response, { status: 201 });\n\n  } catch (error) {\n    console.error('Error al crear reserva:', error);\n    \n    if (error instanceof Error) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: error.message,\n        },\n        { status: 400 }\n      );\n    }\n\n    const errorResult = handleDbError(error);\n    \n    return NextResponse.json(\n      {\n        success: false,\n        error: errorResult.error || 'Error al crear la reserva',\n      },\n      { status: 500 }\n    );\n  }\n}\n\n/**\n * GET /api/reservations\n * Obtiene todas las reservas (para el admin)\n * TODO: Agregar autenticación y paginación\n */\nexport async function GET(request: NextRequest) {\n  try {\n    const searchParams = request.nextUrl.searchParams;\n    const status = searchParams.get('status');\n    const date = searchParams.get('date');\n    const limit = parseInt(searchParams.get('limit') || '50');\n    const offset = parseInt(searchParams.get('offset') || '0');\n\n    let queryText = `\n      SELECT \n        id,\n        reservation_date,\n        reservation_time,\n        location,\n        nombre,\n        apellidos,\n        dni,\n        telefono,\n        email,\n        tipo_misa,\n        intencion,\n        precio,\n        metodo_pago,\n        pago_verificado,\n        status,\n        confirmation_code,\n        created_at\n      FROM mass_reservations\n      WHERE 1=1\n    `;\n\n    const params: string[] = [];\n    let paramCount = 0;\n\n    if (status) {\n      paramCount++;\n      queryText += ` AND status = $${paramCount}`;\n      params.push(status);\n    }\n\n    if (date) {\n      paramCount++;\n      queryText += ` AND reservation_date = $${paramCount}`;\n      params.push(date);\n    }\n\n    queryText += ` ORDER BY reservation_date DESC, reservation_time ASC`;\n    \n    paramCount++;\n    queryText += ` LIMIT $${paramCount}`;\n    params.push(limit.toString());\n    \n    paramCount++;\n    queryText += ` OFFSET $${paramCount}`;\n    params.push(offset.toString());\n\n    const result = await query(queryText, params);\n\n    return NextResponse.json({\n      success: true,\n      data: result.rows,\n      meta: {\n        total: result.rowCount,\n        limit,\n        offset,\n      },\n    });\n\n  } catch (error) {\n    console.error('Error al obtener reservas:', error);\n    const errorResult = handleDbError(error);\n    \n    return NextResponse.json(\n      {\n        success: false,\n        error: errorResult.error || 'Error al obtener las reservas',\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}